const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-N3-yNM-x.js","assets/vendor-CDaM45aE.js","assets/firebase-oRQd-T1V.js","assets/router-ClepU2oc.js","assets/index-CQfFV5PZ.css"])))=>i.map(i=>d[i]);
import{c as z,j as t,l as L,a as G,b as B,_ as g,s as I,d as M,u as H,t as O,L as W}from"./index-N3-yNM-x.js";import{r as l,b as D}from"./vendor-CDaM45aE.js";import{S as y}from"./Section-D1bpE2En.js";import"./firebase-oRQd-T1V.js";import"./router-ClepU2oc.js";function V({T:a,user:o,userProfile:i,setUserProfile:m}){const[c,C]=l.useState(""),[d,$]=l.useState(""),[h,E]=l.useState(""),[P,f]=l.useState(!1),b=!1,[N,U]=l.useState("password"),[n,x]=l.useState("login"),[k,j]=l.useState(!1),[r,u]=l.useState({firstName:"",lastName:"",phone:""}),[v,w]=l.useState(!1);l.useEffect(()=>{z().catch(()=>{})},[]),l.useEffect(()=>{o&&i&&(i.firstName&&i.phone||(j(!0),u({firstName:i.firstName||"",lastName:i.lastName||"",phone:i.phone||""})))},[o,i]);const F=async()=>{try{await G()}catch(e){console.error("❌ Errore Google login:",e);let s=(e==null?void 0:e.message)||String(e);(e==null?void 0:e.code)==="auth/popup-closed-by-user"?s="Popup chiuso. Riprova il login.":(e==null?void 0:e.code)==="auth/unauthorized-domain"?s="Dominio non autorizzato. Controlla la configurazione Firebase Console.":(e==null?void 0:e.code)==="auth/operation-not-allowed"?s="Login Google non abilitato. Controlla la configurazione Firebase Console.":(e==null?void 0:e.code)==="auth/popup-blocked"&&(s="Popup bloccato dal browser. Abilita i popup per questo sito."),alert("Errore Google: "+s)}},S=async()=>{try{await B()}catch(e){alert("Errore Facebook: "+((e==null?void 0:e.message)||e))}},R=async()=>{try{if(f(!0),n==="register"){if(d.length<6){alert("La password deve contenere almeno 6 caratteri.");return}if(h!==d){alert("Le password non coincidono.");return}console.log("🔐 Attempting registration for:",c.trim());const{registerWithEmailPassword:e}=await g(async()=>{const{registerWithEmailPassword:s}=await import("./index-N3-yNM-x.js").then(p=>p.v);return{registerWithEmailPassword:s}},__vite__mapDeps([0,1,2,3,4]));await e(c.trim(),d),console.log("✅ Registration successful")}else{console.log("🔐 Attempting login for:",c.trim());const{loginWithEmailPassword:e}=await g(async()=>{const{loginWithEmailPassword:s}=await import("./index-N3-yNM-x.js").then(p=>p.v);return{loginWithEmailPassword:s}},__vite__mapDeps([0,1,2,3,4]));await e(c.trim(),d),console.log("✅ Login successful")}}catch(e){console.error("❌ Auth error:",e);let s=(e==null?void 0:e.message)||String(e);(e==null?void 0:e.code)==="auth/user-not-found"?s="Account non trovato. Prova a registrarti prima.":(e==null?void 0:e.code)==="auth/wrong-password"?s="Password non corretta.":(e==null?void 0:e.code)==="auth/email-already-in-use"?s="Email già in uso. Prova ad accedere invece di registrarti.":(e==null?void 0:e.code)==="auth/weak-password"?s="Password troppo debole. Usa almeno 6 caratteri.":(e==null?void 0:e.code)==="auth/invalid-email"?s="Formato email non valido.":(e==null?void 0:e.code)==="auth/operation-not-allowed"&&(s="Accesso con email/password non abilitato. Controlla la configurazione Firebase Console."),alert("Errore accesso: "+s)}finally{f(!1)}},_=async()=>{try{const{sendResetPassword:e}=await g(async()=>{const{sendResetPassword:s}=await import("./index-N3-yNM-x.js").then(p=>p.v);return{sendResetPassword:s}},__vite__mapDeps([0,1,2,3,4]));await e(c.trim()),alert("Email per il reset inviata (se l’account esiste).")}catch(e){alert("Errore reset password: "+((e==null?void 0:e.message)||e))}},A=async()=>{if(!r.firstName.trim()){alert("Il nome è obbligatorio");return}if(!r.phone.trim()){alert("Il numero di telefono è obbligatorio");return}try{w(!0);const e={...i,firstName:r.firstName.trim(),lastName:r.lastName.trim(),phone:r.phone.trim(),email:o.email};await I(o.uid,e);const s=[r.firstName,r.lastName].filter(Boolean).join(" ");s&&await M(o,s),m(e),j(!1)}catch(e){alert("Errore salvataggio profilo: "+((e==null?void 0:e.message)||e))}finally{w(!1)}};return o?k||!(i!=null&&i.firstName)||!(i!=null&&i.phone)?t.jsx("div",{className:"space-y-6",children:t.jsx(y,{title:"Completa la Registrazione",T:a,children:t.jsxs("div",{className:`rounded-2xl ${a.cardBg} ${a.border} p-6 space-y-4`,children:[t.jsxs("div",{className:"text-center space-y-2",children:[t.jsxs("h2",{className:"text-xl font-bold",children:["Ciao ",o.displayName||o.email,"!"]}),t.jsx("p",{className:`text-sm ${a.subtext}`,children:"Per completare la registrazione, inserisci i tuoi dati:"})]}),t.jsxs("div",{className:"grid gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"profile-firstname",className:`text-sm font-medium ${a.subtext}`,children:"Nome *"}),t.jsx("input",{id:"profile-firstname",type:"text",value:r.firstName,onChange:e=>u(s=>({...s,firstName:e.target.value})),className:`${a.input} w-full mt-1`,placeholder:"Inserisci il tuo nome"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"profile-lastname",className:`text-sm font-medium ${a.subtext}`,children:"Cognome"}),t.jsx("input",{id:"profile-lastname",type:"text",value:r.lastName,onChange:e=>u(s=>({...s,lastName:e.target.value})),className:`${a.input} w-full mt-1`,placeholder:"Inserisci il tuo cognome"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"profile-phone",className:`text-sm font-medium ${a.subtext}`,children:"Numero di Telefono *"}),t.jsx("input",{id:"profile-phone",type:"tel",value:r.phone,onChange:e=>u(s=>({...s,phone:e.target.value})),className:`${a.input} w-full mt-1`,placeholder:"+39 123 456 7890"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"profile-email",className:`text-sm font-medium ${a.subtext}`,children:"Email"}),t.jsx("input",{id:"profile-email",type:"email",value:o.email||"",disabled:!0,className:`${a.input} w-full mt-1 opacity-50 cursor-not-allowed`})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[t.jsx("button",{type:"button",className:a.btnPrimary,onClick:A,disabled:v,children:v?"Salvando...":"Completa Registrazione"}),t.jsx("button",{type:"button",className:"text-rose-500 hover:opacity-80 text-sm px-4",onClick:()=>L(),children:"Esci"})]}),t.jsx("p",{className:`text-xs ${a.subtext}`,children:"* Campi obbligatori"})]})})}):null:t.jsx("div",{className:"space-y-6",children:t.jsx(y,{title:"Benvenuto in Play-Sport.pro",T:a,children:t.jsxs("div",{className:`rounded-2xl ${a.cardBg} ${a.border} p-6 space-y-4`,children:[t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Accedi o Registrati"}),t.jsx("p",{className:`text-sm ${a.subtext}`,children:"Per accedere alla piattaforma è necessario registrarsi con email, nome e numero di telefono"})]}),t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("button",{type:"button",className:`${a.btnPrimary} flex items-center justify-center gap-2`,onClick:F,children:[t.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[t.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continua con Google"]}),t.jsxs("button",{type:"button",className:`${a.btnGhost} flex items-center justify-center gap-2`,onClick:S,children:[t.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Continua con Facebook"]})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("span",{className:`w-full border-t ${a.border}`})}),t.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:t.jsx("span",{className:`${a.cardBg} px-2 ${a.subtext}`,children:"Oppure"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex gap-2 text-sm",children:[t.jsx("button",{type:"button",className:`${a.btnGhost} ${n==="login"?"opacity-100":"opacity-60"}`,onClick:()=>x("login"),children:"Accedi"}),t.jsx("button",{type:"button",className:`${a.btnGhost} ${n==="register"?"opacity-100":"opacity-60"}`,onClick:()=>x("register"),children:"Registrati"})]}),b,t.jsxs("div",{children:[t.jsx("label",{htmlFor:"auth-email",className:`text-sm font-medium ${a.subtext}`,children:"Email"}),t.jsx("input",{id:"auth-email",type:"email",value:c,placeholder:"esempio@mail.com",onChange:e=>C(e.target.value),className:`${a.input} w-full mt-1`})]}),N==="password"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"auth-password",className:`text-sm font-medium ${a.subtext}`,children:"Password"}),t.jsx("input",{id:"auth-password",type:"password",value:d,placeholder:"Almeno 6 caratteri",onChange:e=>$(e.target.value),className:`${a.input} w-full mt-1`})]}),n==="register"&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"auth-confirm",className:`text-sm font-medium ${a.subtext}`,children:"Conferma password"}),t.jsx("input",{id:"auth-confirm",type:"password",value:h,placeholder:"Ripeti la password",onChange:e=>E(e.target.value),className:`${a.input} w-full mt-1`})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[t.jsx("button",{type:"button",className:a.btnPrimary,disabled:!c||!d||n==="register"&&!h||P,onClick:R,children:n==="register"?"Registrati":"Accedi"}),t.jsx("button",{type:"button",className:a.btnGhost,onClick:()=>x(n==="register"?"login":"register"),children:n==="register"?"Hai già un account? Accedi":"Non hai un account? Registrati"}),n==="login"&&t.jsx("button",{type:"button",className:"text-xs underline",disabled:!c,onClick:_,children:"Recupera password"})]})]}),N==="magic"&&b]})]})})})}function Y(){const{user:a,userProfile:o,setUserProfile:i}=H(),m=D.useMemo(()=>O(),[]);return t.jsxs("div",{className:`min-h-screen ${m.pageBg} ${m.text}`,children:[t.jsx("header",{className:`sticky top-0 z-20 ${m.headerBg}`,children:t.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 py-3 flex items-center justify-between gap-2",children:[t.jsx("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:t.jsx("img",{src:W,alt:"Play-Sport.pro",className:"h-10 w-auto shrink-0"})}),t.jsx("div",{})]})}),t.jsx("main",{className:"max-w-2xl mx-auto px-3 sm:px-4 py-5 sm:py-6",children:t.jsx(V,{T:m,user:a,userProfile:o,setUserProfile:i})})]})}export{Y as default};
